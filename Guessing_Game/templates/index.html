<!doctype html>
<html lang="en" data-theme="light">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Guessing Game</title>
        <link rel="stylesheet" href="/static/style.css">
    </head>
    <body>
        <div class="card">
            <header class="header">
                <h1>ðŸŽ¯ Guessing Game (1â€“100)</h1>
                <button id="themeBtn" class="theme-btn" aria-label="Toggle theme">ðŸŒ™</button>
            </header>
            <form action="/guess" method="post" class="grid">
                <input type="hidden" name="secret" value="{{ secret }}" autocomplete="off">
                <input type="hidden" name="attempts" value="{{ attempts }}" autocomplete="off">
                <div>
                    <label for="guess">Your guess</label>
                    <input
                        id="guess"
                        name="guess"
                        type="text"
                        value="{{ last or '' }}"
                        placeholder="e.g., 42"
                    >
                </div>
                <button type="submit" class="guess-btn">Check</button>
            </form>
            {% if result is not none %}
            <p class="{{ 'ok' if ok else 'hint' }}">{{ result }}</p>
            {% if ok %}
            <form method="get" action="/" style="margin-top:8px;">
                <button type="submit">Play again</button>
            </form>
            {% endif %}
    {% else %}
            <p class="hint">I picked a number. Can you find it?</p>
            {% endif %}
        </div>
        <script>
    const btn = document.getElementById("themeBtn");

    function setTheme(theme) {
      document.documentElement.setAttribute("data-theme", theme);
      localStorage.setItem("guess-theme", theme);
      btn.textContent = theme === "dark" ? "â˜€ï¸" : "ðŸŒ™";
    }

    // init from saved preference or system
    const saved = localStorage.getItem("guess-theme");
    if (saved) setTheme(saved);
    else if (window.matchMedia && window.matchMedia("(prefers-color-scheme: dark)").matches) {
      setTheme("dark");
    }

    btn.addEventListener("click", () => {
      const current = document.documentElement.getAttribute("data-theme") || "light";
      setTheme(current === "light" ? "dark" : "light");
    });
        </script>
    </body>
</html>
